(function(b){var a={set:{colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1,focus:1},get:{selectedRegions:1,selectedMarkers:1,mapObject:1,regionName:1}};
b.fn.vectorMap=function(f){var g,d,c,g=this.children(".jvectormap-container").data("mapObject");
if(f==="addMap"){jvm.WorldMap.maps[arguments[1]]=arguments[2]
}else{if(!(f!=="set"&&f!=="get"||!a[f][arguments[1]])){return d=arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1),g[f+d].apply(g,Array.prototype.slice.call(arguments,2))
}f=f||{},f.container=this,g=new jvm.WorldMap(f)
}return this
}
})(jQuery),function(c){function b(g){var l=g||window.event,j=[].slice.call(arguments,1),f=0,h=!0,k=0,e=0;
return g=c.event.fix(l),g.type="mousewheel",l.wheelDelta&&(f=l.wheelDelta/120),l.detail&&(f=-l.detail/3),e=f,l.axis!==undefined&&l.axis===l.HORIZONTAL_AXIS&&(e=0,k=-1*f),l.wheelDeltaY!==undefined&&(e=l.wheelDeltaY/120),l.wheelDeltaX!==undefined&&(k=-1*l.wheelDeltaX/120),j.unshift(g,f,k,e),(c.event.dispatch||c.event.handle).apply(this,j)
}var a=["DOMMouseScroll","mousewheel"];
if(c.event.fixHooks){for(var d=a.length;
d;
){c.event.fixHooks[a[--d]]=c.event.mouseHooks
}}c.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var f=a.length;
f;
){this.addEventListener(a[--f],b,!1)
}}else{this.onmousewheel=b
}},teardown:function(){if(this.removeEventListener){for(var f=a.length;
f;
){this.removeEventListener(a[--f],b,!1)
}}else{this.onmousewheel=null
}}},c.fn.extend({mousewheel:function(f){return f?this.bind("mousewheel",f):this.trigger("mousewheel")
},unmousewheel:function(f){return this.unbind("mousewheel",f)
}})
}(jQuery);
var jvm={inherits:function(b,a){function c(){}c.prototype=a.prototype,b.prototype=new c,b.prototype.constructor=b,b.parentClass=a
},mixin:function(b,a){var c;
for(c in a.prototype){a.prototype.hasOwnProperty(c)&&(b.prototype[c]=a.prototype[c])
}},min:function(b){var a=Number.MAX_VALUE,c;
if(b instanceof Array){for(c=0;
c<b.length;
c++){b[c]<a&&(a=b[c])
}}else{for(c in b){b[c]<a&&(a=b[c])
}}return a
},max:function(b){var a=Number.MIN_VALUE,c;
if(b instanceof Array){for(c=0;
c<b.length;
c++){b[c]>a&&(a=b[c])
}}else{for(c in b){b[c]>a&&(a=b[c])
}}return a
},keys:function(b){var a=[],c;
for(c in b){a.push(c)
}return a
},values:function(c){var a=[],d,b;
for(b=0;
b<arguments.length;
b++){c=arguments[b];
for(d in c){a.push(c[d])
}}return a
}};
jvm.$=jQuery,jvm.AbstractElement=function(b,a){this.node=this.createElement(b),this.name=b,this.properties={},a&&this.set(a)
},jvm.AbstractElement.prototype.set=function(b,a){var c;
if(typeof b=="object"){for(c in b){this.properties[c]=b[c],this.applyAttr(c,b[c])
}}else{this.properties[b]=a,this.applyAttr(b,a)
}},jvm.AbstractElement.prototype.get=function(a){return this.properties[a]
},jvm.AbstractElement.prototype.applyAttr=function(b,a){this.node.setAttribute(b,a)
},jvm.AbstractElement.prototype.remove=function(){jvm.$(this.node).remove()
},jvm.AbstractCanvasElement=function(b,a,c){this.container=b,this.setSize(a,c),this.rootElement=new jvm[this.classPrefix+"GroupElement"],this.node.appendChild(this.rootElement.node),this.container.appendChild(this.node)
},jvm.AbstractCanvasElement.prototype.add=function(b,a){a=a||this.rootElement,a.add(b),b.canvas=this
},jvm.AbstractCanvasElement.prototype.addPath=function(c,a,d){var b=new jvm[this.classPrefix+"PathElement"](c,a);
return this.add(b,d),b
},jvm.AbstractCanvasElement.prototype.addCircle=function(c,a,d){var b=new jvm[this.classPrefix+"CircleElement"](c,a);
return this.add(b,d),b
},jvm.AbstractCanvasElement.prototype.addGroup=function(b){var a=new jvm[this.classPrefix+"GroupElement"];
return b?b.node.appendChild(a.node):this.node.appendChild(a.node),a.canvas=this,a
},jvm.AbstractShapeElement=function(b,a,c){this.style=c||{},this.style.current={},this.isHovered=!1,this.isSelected=!1,this.updateStyle()
},jvm.AbstractShapeElement.prototype.setHovered=function(a){this.isHovered!==a&&(this.isHovered=a,this.updateStyle())
},jvm.AbstractShapeElement.prototype.setSelected=function(a){this.isSelected!==a&&(this.isSelected=a,this.updateStyle(),jvm.$(this.node).trigger("selected",[a]))
},jvm.AbstractShapeElement.prototype.setStyle=function(b,a){var c={};
typeof b=="object"?c=b:c[b]=a,jvm.$.extend(this.style.current,c),this.updateStyle()
},jvm.AbstractShapeElement.prototype.updateStyle=function(){var a={};
jvm.AbstractShapeElement.mergeStyles(a,this.style.initial),jvm.AbstractShapeElement.mergeStyles(a,this.style.current),this.isHovered&&jvm.AbstractShapeElement.mergeStyles(a,this.style.hover),this.isSelected&&(jvm.AbstractShapeElement.mergeStyles(a,this.style.selected),this.isHovered&&jvm.AbstractShapeElement.mergeStyles(a,this.style.selectedHover)),this.set(a)
},jvm.AbstractShapeElement.mergeStyles=function(b,a){var c;
a=a||{};
for(c in a){a[c]===null?delete b[c]:b[c]=a[c]
}},jvm.SVGElement=function(b,a){jvm.SVGElement.parentClass.apply(this,arguments)
},jvm.inherits(jvm.SVGElement,jvm.AbstractElement),jvm.SVGElement.svgns="http://www.w3.org/2000/svg",jvm.SVGElement.prototype.createElement=function(a){return document.createElementNS(jvm.SVGElement.svgns,a)
},jvm.SVGElement.prototype.addClass=function(a){this.node.setAttribute("class",a)
},jvm.SVGElement.prototype.getElementCtr=function(a){return jvm["SVG"+a]
},jvm.SVGElement.prototype.getBBox=function(){return this.node.getBBox()
},jvm.SVGGroupElement=function(){jvm.SVGGroupElement.parentClass.call(this,"g")
},jvm.inherits(jvm.SVGGroupElement,jvm.SVGElement),jvm.SVGGroupElement.prototype.add=function(a){this.node.appendChild(a.node)
},jvm.SVGCanvasElement=function(b,a,c){this.classPrefix="SVG",jvm.SVGCanvasElement.parentClass.call(this,"svg"),jvm.AbstractCanvasElement.apply(this,arguments)
},jvm.inherits(jvm.SVGCanvasElement,jvm.SVGElement),jvm.mixin(jvm.SVGCanvasElement,jvm.AbstractCanvasElement),jvm.SVGCanvasElement.prototype.setSize=function(b,a){this.width=b,this.height=a,this.node.setAttribute("width",b),this.node.setAttribute("height",a)
},jvm.SVGCanvasElement.prototype.applyTransformParams=function(b,a,c){this.scale=b,this.transX=a,this.transY=c,this.rootElement.node.setAttribute("transform","scale("+b+") translate("+a+", "+c+")")
},jvm.SVGShapeElement=function(b,a,c){jvm.SVGShapeElement.parentClass.call(this,b,a),jvm.AbstractShapeElement.apply(this,arguments)
},jvm.inherits(jvm.SVGShapeElement,jvm.SVGElement),jvm.mixin(jvm.SVGShapeElement,jvm.AbstractShapeElement),jvm.SVGPathElement=function(b,a){jvm.SVGPathElement.parentClass.call(this,"path",b,a),this.node.setAttribute("fill-rule","evenodd")
},jvm.inherits(jvm.SVGPathElement,jvm.SVGShapeElement),jvm.SVGCircleElement=function(b,a){jvm.SVGCircleElement.parentClass.call(this,"circle",b,a)
},jvm.inherits(jvm.SVGCircleElement,jvm.SVGShapeElement),jvm.VMLElement=function(b,a){jvm.VMLElement.VMLInitialized||jvm.VMLElement.initializeVML(),jvm.VMLElement.parentClass.apply(this,arguments)
},jvm.inherits(jvm.VMLElement,jvm.AbstractElement),jvm.VMLElement.VMLInitialized=!1,jvm.VMLElement.initializeVML=function(){try{document.namespaces.rvml||document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),jvm.VMLElement.prototype.createElement=function(b){return document.createElement("<rvml:"+b+' class="rvml">')
}
}catch(a){jvm.VMLElement.prototype.createElement=function(b){return document.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')
}
}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"),jvm.VMLElement.VMLInitialized=!0
},jvm.VMLElement.prototype.getElementCtr=function(a){return jvm["VML"+a]
},jvm.VMLElement.prototype.addClass=function(a){jvm.$(this.node).addClass(a)
},jvm.VMLElement.prototype.applyAttr=function(b,a){this.node[b]=a
},jvm.VMLElement.prototype.getBBox=function(){var a=jvm.$(this.node);
return{x:a.position().left/this.canvas.scale,y:a.position().top/this.canvas.scale,width:a.width()/this.canvas.scale,height:a.height()/this.canvas.scale}
},jvm.VMLGroupElement=function(){jvm.VMLGroupElement.parentClass.call(this,"group"),this.node.style.left="0px",this.node.style.top="0px",this.node.coordorigin="0 0"
},jvm.inherits(jvm.VMLGroupElement,jvm.VMLElement),jvm.VMLGroupElement.prototype.add=function(a){this.node.appendChild(a.node)
},jvm.VMLCanvasElement=function(b,a,c){this.classPrefix="VML",jvm.VMLCanvasElement.parentClass.call(this,"group"),jvm.AbstractCanvasElement.apply(this,arguments),this.node.style.position="absolute"
},jvm.inherits(jvm.VMLCanvasElement,jvm.VMLElement),jvm.mixin(jvm.VMLCanvasElement,jvm.AbstractCanvasElement),jvm.VMLCanvasElement.prototype.setSize=function(f,b){var g,d,a,c;
this.width=f,this.height=b,this.node.style.width=f+"px",this.node.style.height=b+"px",this.node.coordsize=f+" "+b,this.node.coordorigin="0 0";
if(this.rootElement){g=this.rootElement.node.getElementsByTagName("shape");
for(a=0,c=g.length;
a<c;
a++){g[a].coordsize=f+" "+b,g[a].style.width=f+"px",g[a].style.height=b+"px"
}d=this.node.getElementsByTagName("group");
for(a=0,c=d.length;
a<c;
a++){d[a].coordsize=f+" "+b,d[a].style.width=f+"px",d[a].style.height=b+"px"
}}},jvm.VMLCanvasElement.prototype.applyTransformParams=function(b,a,c){this.scale=b,this.transX=a,this.transY=c,this.rootElement.node.coordorigin=this.width-a-this.width/100+","+(this.height-c-this.height/100),this.rootElement.node.coordsize=this.width/b+","+this.height/b
},jvm.VMLShapeElement=function(b,a){jvm.VMLShapeElement.parentClass.call(this,b,a),this.fillElement=new jvm.VMLElement("fill"),this.strokeElement=new jvm.VMLElement("stroke"),this.node.appendChild(this.fillElement.node),this.node.appendChild(this.strokeElement.node),this.node.stroked=!1,jvm.AbstractShapeElement.apply(this,arguments)
},jvm.inherits(jvm.VMLShapeElement,jvm.VMLElement),jvm.mixin(jvm.VMLShapeElement,jvm.AbstractShapeElement),jvm.VMLShapeElement.prototype.applyAttr=function(b,a){switch(b){case"fill":this.node.fillcolor=a;
break;
case"fill-opacity":this.fillElement.node.opacity=Math.round(a*100)+"%";
break;
case"stroke":a==="none"?this.node.stroked=!1:this.node.stroked=!0,this.node.strokecolor=a;
break;
case"stroke-opacity":this.strokeElement.node.opacity=Math.round(a*100)+"%";
break;
case"stroke-width":parseInt(a,10)===0?this.node.stroked=!1:this.node.stroked=!0,this.node.strokeweight=a;
break;
case"d":this.node.path=jvm.VMLPathElement.pathSvgToVml(a);
break;
default:jvm.VMLShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)
}},jvm.VMLPathElement=function(b,a){var c=new jvm.VMLElement("skew");
jvm.VMLPathElement.parentClass.call(this,"shape",b,a),this.node.coordorigin="0 0",c.node.on=!0,c.node.matrix="0.01,0,0,0.01,0,0",c.node.offset="0,0",this.node.appendChild(c.node)
},jvm.inherits(jvm.VMLPathElement,jvm.VMLShapeElement),jvm.VMLPathElement.prototype.applyAttr=function(b,a){b==="d"?this.node.path=jvm.VMLPathElement.pathSvgToVml(a):jvm.VMLShapeElement.prototype.applyAttr.call(this,b,a)
},jvm.VMLPathElement.pathSvgToVml=function(f){var b="",g=0,d=0,a,c;
return f=f.replace(/(-?\d+)e(-?\d+)/g,"0"),f.replace(/([MmLlHhVvCcSs])\s*((?:-?\d*(?:\.\d+)?\s*,?\s*)+)/g,function(l,j,m,i){m=m.replace(/(\d)-/g,"$1,-").replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/\s+/g,",").split(","),m[0]||m.shift();
for(var h=0,k=m.length;
h<k;
h++){m[h]=Math.round(100*m[h])
}switch(j){case"m":return g+=m[0],d+=m[1],"t"+m.join(",");
case"M":return g=m[0],d=m[1],"m"+m.join(",");
case"l":return g+=m[0],d+=m[1],"r"+m.join(",");
case"L":return g=m[0],d=m[1],"l"+m.join(",");
case"h":return g+=m[0],"r"+m[0]+",0";
case"H":return g=m[0],"l"+g+","+d;
case"v":return d+=m[0],"r0,"+m[0];
case"V":return d=m[0],"l"+g+","+d;
case"c":return a=g+m[m.length-4],c=d+m[m.length-3],g+=m[m.length-2],d+=m[m.length-1],"v"+m.join(",");
case"C":return a=m[m.length-4],c=m[m.length-3],g=m[m.length-2],d=m[m.length-1],"c"+m.join(",");
case"s":return m.unshift(d-c),m.unshift(g-a),a=g+m[m.length-4],c=d+m[m.length-3],g+=m[m.length-2],d+=m[m.length-1],"v"+m.join(",");
case"S":return m.unshift(d+d-c),m.unshift(g+g-a),a=m[m.length-4],c=m[m.length-3],g=m[m.length-2],d=m[m.length-1],"c"+m.join(",")
}return""
}).replace(/z/g,"e")
},jvm.VMLCircleElement=function(b,a){jvm.VMLCircleElement.parentClass.call(this,"oval",b,a)
},jvm.inherits(jvm.VMLCircleElement,jvm.VMLShapeElement),jvm.VMLCircleElement.prototype.applyAttr=function(b,a){switch(b){case"r":this.node.style.width=a*2+"px",this.node.style.height=a*2+"px",this.applyAttr("cx",this.get("cx")||0),this.applyAttr("cy",this.get("cy")||0);
break;
case"cx":if(!a){return
}this.node.style.left=a-(this.get("r")||0)+"px";
break;
case"cy":if(!a){return
}this.node.style.top=a-(this.get("r")||0)+"px";
break;
default:jvm.VMLCircleElement.parentClass.prototype.applyAttr.call(this,b,a)
}},jvm.VectorCanvas=function(b,a,c){return this.mode=window.SVGAngle?"svg":"vml",this.mode=="svg"?this.impl=new jvm.SVGCanvasElement(b,a,c):this.impl=new jvm.VMLCanvasElement(b,a,c),this.impl
},jvm.SimpleScale=function(a){this.scale=a
},jvm.SimpleScale.prototype.getValue=function(a){return a
},jvm.OrdinalScale=function(a){this.scale=a
},jvm.OrdinalScale.prototype.getValue=function(a){return this.scale[a]
},jvm.NumericScale=function(c,a,d,b){this.scale=[],a=a||"linear",c&&this.setScale(c),a&&this.setNormalizeFunction(a),d&&this.setMin(d),b&&this.setMax(b)
},jvm.NumericScale.prototype={setMin:function(a){this.clearMinValue=a,typeof this.normalize=="function"?this.minValue=this.normalize(a):this.minValue=a
},setMax:function(a){this.clearMaxValue=a,typeof this.normalize=="function"?this.maxValue=this.normalize(a):this.maxValue=a
},setScale:function(b){var a;
for(a=0;
a<b.length;
a++){this.scale[a]=[b[a]]
}},setNormalizeFunction:function(a){a==="polynomial"?this.normalize=function(b){return Math.pow(b,0.2)
}:a==="linear"?delete this.normalize:this.normalize=a,this.setMin(this.clearMinValue),this.setMax(this.clearMaxValue)
},getValue:function(f){var b=[],g=0,d,a=0,c;
typeof this.normalize=="function"&&(f=this.normalize(f));
for(a=0;
a<this.scale.length-1;
a++){d=this.vectorLength(this.vectorSubtract(this.scale[a+1],this.scale[a])),b.push(d),g+=d
}c=(this.maxValue-this.minValue)/g;
for(a=0;
a<b.length;
a++){b[a]*=c
}a=0,f-=this.minValue;
while(f-b[a]>=0){f-=b[a],a++
}return a==this.scale.length-1?f=this.vectorToNum(this.scale[a]):f=this.vectorToNum(this.vectorAdd(this.scale[a],this.vectorMult(this.vectorSubtract(this.scale[a+1],this.scale[a]),f/b[a]))),f
},vectorToNum:function(b){var a=0,c;
for(c=0;
c<b.length;
c++){a+=Math.round(b[c])*Math.pow(256,b.length-c-1)
}return a
},vectorSubtract:function(c,a){var d=[],b;
for(b=0;
b<c.length;
b++){d[b]=c[b]-a[b]
}return d
},vectorAdd:function(c,a){var d=[],b;
for(b=0;
b<c.length;
b++){d[b]=c[b]+a[b]
}return d
},vectorMult:function(c,a){var d=[],b;
for(b=0;
b<c.length;
b++){d[b]=c[b]*a
}return d
},vectorLength:function(b){var a=0,c;
for(c=0;
c<b.length;
c++){a+=b[c]*b[c]
}return Math.sqrt(a)
}},jvm.ColorScale=function(c,a,d,b){jvm.ColorScale.parentClass.apply(this,arguments)
},jvm.inherits(jvm.ColorScale,jvm.NumericScale),jvm.ColorScale.prototype.setScale=function(b){var a;
for(a=0;
a<b.length;
a++){this.scale[a]=jvm.ColorScale.rgbToArray(b[a])
}},jvm.ColorScale.prototype.getValue=function(a){return jvm.ColorScale.numToRgb(jvm.ColorScale.parentClass.prototype.getValue.call(this,a))
},jvm.ColorScale.arrayToRgb=function(c){var a="#",d,b;
for(b=0;
b<c.length;
b++){d=c[b].toString(16),a+=d.length==1?"0"+d:d
}return a
},jvm.ColorScale.numToRgb=function(a){a=a.toString(16);
while(a.length<6){a="0"+a
}return"#"+a
},jvm.ColorScale.rgbToArray=function(a){return a=a.substr(1),[parseInt(a.substr(0,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(4,2),16)]
},jvm.DataSeries=function(b,a){var c;
b=b||{},b.attribute=b.attribute||"fill",this.elements=a,this.params=b,b.attributes&&this.setAttributes(b.attributes),jvm.$.isArray(b.scale)?(c=b.attribute==="fill"||b.attribute==="stroke"?jvm.ColorScale:jvm.NumericScale,this.scale=new c(b.scale,b.normalizeFunction,b.min,b.max)):b.scale?this.scale=new jvm.OrdinalScale(b.scale):this.scale=new jvm.SimpleScale(b.scale),this.values=b.values||{},this.setValues(this.values)
},jvm.DataSeries.prototype={setAttributes:function(c,a){var d=c,b;
if(typeof c=="string"){this.elements[c]&&this.elements[c].setStyle(this.params.attribute,a)
}else{for(b in d){this.elements[b]&&this.elements[b].element.setStyle(this.params.attribute,d[b])
}}},setValues:function(f){var b=Number.MIN_VALUE,g=Number.MAX_VALUE,d,a,c={};
if(this.scale instanceof jvm.OrdinalScale||this.scale instanceof jvm.SimpleScale){for(a in f){f[a]?c[a]=this.scale.getValue(f[a]):c[a]=this.elements[a].element.style.initial[this.params.attribute]
}}else{if(!this.params.min||!this.params.max){for(a in f){d=parseFloat(f[a]),d>b&&(b=f[a]),d<g&&(g=d)
}this.params.min||this.scale.setMin(g),this.params.max||this.scale.setMax(b),this.params.min=g,this.params.max=b
}for(a in f){d=parseFloat(f[a]),isNaN(d)?c[a]=this.elements[a].element.style.initial[this.params.attribute]:c[a]=this.scale.getValue(d)
}}this.setAttributes(c),jvm.$.extend(this.values,f)
},clear:function(){var b,a={};
for(b in this.values){this.elements[b]&&(a[b]=this.elements[b].element.style.initial[this.params.attribute])
}this.setAttributes(a),this.values={}
},setScale:function(a){this.scale.setScale(a),this.values&&this.setValues(this.values)
},setNormalizeFunction:function(a){this.scale.setNormalizeFunction(a),this.values&&this.setValues(this.values)
}},jvm.Proj={degRad:180/Math.PI,radDeg:Math.PI/180,radius:6381372,sgn:function(a){return a>0?1:a<0?-1:a
},mill:function(b,a,c){return{x:this.radius*(a-c)*this.radDeg,y:-this.radius*Math.log(Math.tan((45+0.4*b)*this.radDeg))/0.8}
},mill_inv:function(b,a,c){return{lat:(2.5*Math.atan(Math.exp(0.8*a/this.radius))-5*Math.PI/8)*this.degRad,lng:(c*this.radDeg+b/this.radius)*this.degRad}
},merc:function(b,a,c){return{x:this.radius*(a-c)*this.radDeg,y:-this.radius*Math.log(Math.tan(Math.PI/4+b*Math.PI/360))}
},merc_inv:function(b,a,c){return{lat:(2*Math.atan(Math.exp(a/this.radius))-Math.PI/2)*this.degRad,lng:(c*this.radDeg+b/this.radius)*this.degRad}
},aea:function(w,A,j){var b=0,m=j*this.radDeg,B=29.5*this.radDeg,g=45.5*this.radDeg,z=w*this.radDeg,y=A*this.radDeg,v=(Math.sin(B)+Math.sin(g))/2,k=Math.cos(B)*Math.cos(B)+2*v*Math.sin(B),x=v*(y-m),q=Math.sqrt(k-2*v*Math.sin(z))/v,d=Math.sqrt(k-2*v*Math.sin(b))/v;
return{x:q*Math.sin(x)*this.radius,y:-(d-q*Math.cos(x))*this.radius}
},aea_inv:function(w,A,j){var b=w/this.radius,m=A/this.radius,B=0,g=j*this.radDeg,z=29.5*this.radDeg,y=45.5*this.radDeg,v=(Math.sin(z)+Math.sin(y))/2,k=Math.cos(z)*Math.cos(z)+2*v*Math.sin(z),x=Math.sqrt(k-2*v*Math.sin(B))/v,q=Math.sqrt(b*b+(x-m)*(x-m)),d=Math.atan(b/(x-m));
return{lat:Math.asin((k-q*q*v*v)/(2*v))*this.degRad,lng:(g+d/v)*this.degRad}
},lcc:function(q,y,g){var b=0,k=g*this.radDeg,z=y*this.radDeg,d=33*this.radDeg,x=45*this.radDeg,w=q*this.radDeg,p=Math.log(Math.cos(d)*(1/Math.cos(x)))/Math.log(Math.tan(Math.PI/4+x/2)*(1/Math.tan(Math.PI/4+d/2))),j=Math.cos(d)*Math.pow(Math.tan(Math.PI/4+d/2),p)/p,v=j*Math.pow(1/Math.tan(Math.PI/4+w/2),p),m=j*Math.pow(1/Math.tan(Math.PI/4+b/2),p);
return{x:v*Math.sin(p*(z-k))*this.radius,y:-(m-v*Math.cos(p*(z-k)))*this.radius}
},lcc_inv:function(w,A,j){var b=w/this.radius,m=A/this.radius,B=0,g=j*this.radDeg,z=33*this.radDeg,y=45*this.radDeg,v=Math.log(Math.cos(z)*(1/Math.cos(y)))/Math.log(Math.tan(Math.PI/4+y/2)*(1/Math.tan(Math.PI/4+z/2))),k=Math.cos(z)*Math.pow(Math.tan(Math.PI/4+z/2),v)/v,x=k*Math.pow(1/Math.tan(Math.PI/4+B/2),v),q=this.sgn(v)*Math.sqrt(b*b+(x-m)*(x-m)),d=Math.atan(b/(x-m));
return{lat:(2*Math.atan(Math.pow(k/q,1/v))-Math.PI/2)*this.degRad,lng:(g+d/v)*this.degRad}
}},jvm.WorldMap=function(b){var a=this,c;
this.params=jvm.$.extend(!0,{},jvm.WorldMap.defaultParams,b);
if(!jvm.WorldMap.maps[this.params.map]){throw new Error("Attempt to use map which was not loaded: "+this.params.map)
}this.mapData=jvm.WorldMap.maps[this.params.map],this.markers={},this.regions={},this.regionsColors={},this.regionsData={},this.container=jvm.$("<div>").css({width:"100%",height:"100%"}).addClass("jvectormap-container"),this.params.container.append(this.container),this.container.data("mapObject",this),this.container.css({position:"relative",overflow:"hidden"}),this.defaultWidth=this.mapData.width,this.defaultHeight=this.mapData.height,this.setBackgroundColor(this.params.backgroundColor),this.onResize=function(){a.setSize()
},jvm.$(window).resize(this.onResize);
for(c in jvm.WorldMap.apiEvents){this.params[c]&&this.container.bind(jvm.WorldMap.apiEvents[c]+".jvectormap",this.params[c])
}this.canvas=new jvm.VectorCanvas(this.container[0],this.width,this.height),"ontouchstart" in window||window.DocumentTouch&&document instanceof DocumentTouch?this.params.bindTouchEvents&&this.bindContainerTouchEvents():this.bindContainerEvents(),this.bindElementEvents(),this.createLabel(),this.params.zoomButtons&&this.bindZoomButtons(),this.createRegions(),this.createMarkers(this.params.markers||{}),this.setSize(),this.params.focusOn&&(typeof this.params.focusOn=="object"?this.setFocus.call(this,this.params.focusOn.scale,this.params.focusOn.x,this.params.focusOn.y):this.setFocus.call(this,this.params.focusOn)),this.params.selectedRegions&&this.setSelectedRegions(this.params.selectedRegions),this.params.selectedMarkers&&this.setSelectedMarkers(this.params.selectedMarkers),this.params.series&&this.createSeries()
},jvm.WorldMap.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,setBackgroundColor:function(a){this.container.css("background-color",a)
},resize:function(){var a=this.baseScale;
this.width/this.height>this.defaultWidth/this.defaultHeight?(this.baseScale=this.height/this.defaultHeight,this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)):(this.baseScale=this.width/this.defaultWidth,this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)),this.scale*=this.baseScale/a,this.transX*=this.baseScale/a,this.transY*=this.baseScale/a
},setSize:function(){this.width=this.container.width(),this.height=this.container.height(),this.resize(),this.canvas.setSize(this.width,this.height),this.applyTransform()
},reset:function(){var b,a;
for(b in this.series){for(a=0;
a<this.series[b].length;
a++){this.series[b][a].clear()
}}this.scale=this.baseScale,this.transX=this.baseTransX,this.transY=this.baseTransY,this.applyTransform()
},applyTransform:function(){var c,a,d,b;
this.defaultWidth*this.scale<=this.width?(c=(this.width-this.defaultWidth*this.scale)/(2*this.scale),d=(this.width-this.defaultWidth*this.scale)/(2*this.scale)):(c=0,d=(this.width-this.defaultWidth*this.scale)/this.scale),this.defaultHeight*this.scale<=this.height?(a=(this.height-this.defaultHeight*this.scale)/(2*this.scale),b=(this.height-this.defaultHeight*this.scale)/(2*this.scale)):(a=0,b=(this.height-this.defaultHeight*this.scale)/this.scale),this.transY>a?this.transY=a:this.transY<b&&(this.transY=b),this.transX>c?this.transX=c:this.transX<d&&(this.transX=d),this.canvas.applyTransformParams(this.scale,this.transX,this.transY),this.markers&&this.repositionMarkers(),this.container.trigger("viewportChange",[this.scale/this.baseScale,this.transX,this.transY])
},bindContainerEvents:function(){var c=!1,a,d,b=this;
this.container.mousemove(function(e){return c&&(b.transX-=(a-e.pageX)/b.scale,b.transY-=(d-e.pageY)/b.scale,b.applyTransform(),a=e.pageX,d=e.pageY),!1
}).mousedown(function(e){return c=!0,a=e.pageX,d=e.pageY,!1
}),jvm.$("body").mouseup(function(){c=!1
}),this.params.zoomOnScroll&&this.container.mousewheel(function(l,j,p,h){var k=jvm.$(b.container).offset(),m=l.pageX-k.left,g=l.pageY-k.top,f=Math.pow(1.3,h);
b.label.hide(),b.setScale(b.scale*f,m,g),l.preventDefault()
})
},bindContainerTouchEvents:function(){var g,k,d=this,b,f,l,c,j,h=function(i){var n=i.originalEvent.touches,e,q,m,o;
i.type=="touchstart"&&(j=0),n.length==1?(j==1&&(m=d.transX,o=d.transY,d.transX-=(b-n[0].pageX)/d.scale,d.transY-=(f-n[0].pageY)/d.scale,d.applyTransform(),d.label.hide(),(m!=d.transX||o!=d.transY)&&i.preventDefault()),b=n[0].pageX,f=n[0].pageY):n.length==2&&(j==2?(q=Math.sqrt(Math.pow(n[0].pageX-n[1].pageX,2)+Math.pow(n[0].pageY-n[1].pageY,2))/k,d.setScale(g*q,l,c),d.label.hide(),i.preventDefault()):(e=jvm.$(d.container).offset(),n[0].pageX>n[1].pageX?l=n[1].pageX+(n[0].pageX-n[1].pageX)/2:l=n[0].pageX+(n[1].pageX-n[0].pageX)/2,n[0].pageY>n[1].pageY?c=n[1].pageY+(n[0].pageY-n[1].pageY)/2:c=n[0].pageY+(n[1].pageY-n[0].pageY)/2,l-=e.left,c-=e.top,g=d.scale,k=Math.sqrt(Math.pow(n[0].pageX-n[1].pageX,2)+Math.pow(n[0].pageY-n[1].pageY,2)))),j=n.length
};
jvm.$(this.container).bind("touchstart",h),jvm.$(this.container).bind("touchmove",h)
},bindElementEvents:function(){var b=this,a;
this.container.mousemove(function(){a=!0
}),this.container.delegate("[class~='jvectormap-element']","mouseover mouseout",function(l){var e=this,c=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),g=c.indexOf("jvectormap-region")===-1?"marker":"region",m=g=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),d=g=="region"?b.regions[m].element:b.markers[m].element,k=g=="region"?b.mapData.paths[m].name:b.markers[m].config.name||"",j=jvm.$.Event(g+"LabelShow.jvectormap"),h=jvm.$.Event(g+"Over.jvectormap");
l.type=="mouseover"?(b.container.trigger(h,[m]),h.isDefaultPrevented()||d.setHovered(!0),b.label.text(k),b.container.trigger(j,[b.label,m]),j.isDefaultPrevented()||(b.label.show(),b.labelWidth=b.label.width(),b.labelHeight=b.label.height())):(d.setHovered(!1),b.label.hide(),b.container.trigger(g+"Out.jvectormap",[m]))
}),this.container.delegate("[class~='jvectormap-element']","mousedown",function(c){a=!1
}),this.container.delegate("[class~='jvectormap-element']","mouseup",function(j){var g=this,e=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),f=e.indexOf("jvectormap-region")===-1?"marker":"region",h=f=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),d=jvm.$.Event(f+"Click.jvectormap"),c=f=="region"?b.regions[h].element:b.markers[h].element;
if(!a){b.container.trigger(d,[h]);
if(f==="region"&&b.params.regionsSelectable||f==="marker"&&b.params.markersSelectable){d.isDefaultPrevented()||(b.params[f+"sSelectableOne"]&&b.clearSelected(f+"s"),c.setSelected(!c.isSelected))
}}})
},bindZoomButtons:function(){var a=this;
jvm.$("<div/>").addClass("jvectormap-zoomin").text("+").appendTo(this.container),jvm.$("<div/>").addClass("jvectormap-zoomout").html("&#x2212;").appendTo(this.container),this.container.find(".jvectormap-zoomin").click(function(){a.setScale(a.scale*a.params.zoomStep,a.width/2,a.height/2)
}),this.container.find(".jvectormap-zoomout").click(function(){a.setScale(a.scale/a.params.zoomStep,a.width/2,a.height/2)
})
},createLabel:function(){var a=this;
this.label=jvm.$("<div/>").addClass("jvectormap-label").appendTo(jvm.$("body")),this.container.mousemove(function(b){var d=b.pageX-15-a.labelWidth,c=b.pageY-15-a.labelHeight;
d<5&&(d=b.pageX+15),c<5&&(c=b.pageY+15),a.label.is(":visible")&&a.label.css({left:d,top:c})
})
},setScale:function(f,b,g,d){var a,c=jvm.$.Event("zoom.jvectormap");
f>this.params.zoomMax*this.baseScale?f=this.params.zoomMax*this.baseScale:f<this.params.zoomMin*this.baseScale&&(f=this.params.zoomMin*this.baseScale),typeof b!="undefined"&&typeof g!="undefined"&&(a=f/this.scale,d?(this.transX=b+this.defaultWidth*(this.width/(this.defaultWidth*f))/2,this.transY=g+this.defaultHeight*(this.height/(this.defaultHeight*f))/2):(this.transX-=(a-1)/f*b,this.transY-=(a-1)/f*g)),this.scale=f,this.applyTransform(),this.container.trigger(c,[f/this.baseScale])
},setFocus:function(g,c,j){var f,b,d,h,a;
if(jvm.$.isArray(g)||this.regions[g]){jvm.$.isArray(g)?h=g:h=[g];
for(a=0;
a<h.length;
a++){this.regions[h[a]]&&(b=this.regions[h[a]].element.getBBox(),b&&(typeof f=="undefined"?f=b:(d={x:Math.min(f.x,b.x),y:Math.min(f.y,b.y),width:Math.max(f.x+f.width,b.x+b.width)-Math.min(f.x,b.x),height:Math.max(f.y+f.height,b.y+b.height)-Math.min(f.y,b.y)},f=d)))
}this.setScale(Math.min(this.width/f.width,this.height/f.height),-(f.x+f.width/2),-(f.y+f.height/2),!0)
}else{g*=this.baseScale,this.setScale(g,-c*this.defaultWidth,-j*this.defaultHeight,!0)
}},getSelected:function(b){var a,c=[];
for(a in this[b]){this[b][a].element.isSelected&&c.push(a)
}return c
},getSelectedRegions:function(){return this.getSelected("regions")
},getSelectedMarkers:function(){return this.getSelected("markers")
},setSelected:function(b,a){var c;
typeof a!="object"&&(a=[a]);
if(jvm.$.isArray(a)){for(c=0;
c<a.length;
c++){this[b][a[c]].element.setSelected(!0)
}}else{for(c in a){this[b][c].element.setSelected(!!a[c])
}}},setSelectedRegions:function(a){this.setSelected("regions",a)
},setSelectedMarkers:function(a){this.setSelected("markers",a)
},clearSelected:function(c){var a={},d=this.getSelected(c),b;
for(b=0;
b<d.length;
b++){a[d[b]]=!1
}this.setSelected(c,a)
},clearSelectedRegions:function(){this.clearSelected("regions")
},clearSelectedMarkers:function(){this.clearSelected("markers")
},getMapObject:function(){return this
},getRegionName:function(a){return this.mapData.paths[a].name
},createRegions:function(){var b,a,c=this;
for(b in this.mapData.paths){a=this.canvas.addPath({d:this.mapData.paths[b].path,"data-code":b},jvm.$.extend(!0,{},this.params.regionStyle)),jvm.$(a.node).bind("selected",function(f,d){c.container.trigger("regionSelected.jvectormap",[jvm.$(this).attr("data-code"),d,c.getSelectedRegions()])
}),a.addClass("jvectormap-region jvectormap-element"),this.regions[b]={element:a,config:this.mapData.paths[b]}
}},createMarkers:function(f){var b,h,d,a,c,g=this;
this.markersGroup=this.markersGroup||this.canvas.addGroup();
if(jvm.$.isArray(f)){c=f.slice(),f={};
for(b=0;
b<c.length;
b++){f[b]=c[b]
}}for(b in f){a=f[b] instanceof Array?{latLng:f[b]}:f[b],d=this.getMarkerPosition(a),d!==!1&&(h=this.canvas.addCircle({"data-index":b,cx:d.x,cy:d.y},jvm.$.extend(!0,{},this.params.markerStyle,{initial:a.style||{}}),this.markersGroup),h.addClass("jvectormap-marker jvectormap-element"),jvm.$(h.node).bind("selected",function(j,i){g.container.trigger("markerSelected.jvectormap",[jvm.$(this).attr("data-index"),i,g.getSelectedMarkers()])
}),this.markers[b]&&this.removeMarkers([b]),this.markers[b]={element:h,config:a})
}},repositionMarkers:function(){var b,a;
for(b in this.markers){a=this.getMarkerPosition(this.markers[b].config),a!==!1&&this.markers[b].element.setStyle({cx:a.x,cy:a.y})
}},getMarkerPosition:function(a){return jvm.WorldMap.maps[this.params.map].projection?this.latLngToPoint.apply(this,a.latLng||[0,0]):{x:a.coords[0]*this.scale+this.transX*this.scale,y:a.coords[1]*this.scale+this.transY*this.scale}
},addMarker:function(f,b,h){var d={},a=[],c,g,h=h||[];
d[f]=b;
for(g=0;
g<h.length;
g++){c={},c[f]=h[g],a.push(c)
}this.addMarkers(d,a)
},addMarkers:function(b,a){var c;
a=a||[],this.createMarkers(b);
for(c=0;
c<a.length;
c++){this.series.markers[c].setValues(a[c]||{})
}},removeMarkers:function(b){var a;
for(a=0;
a<b.length;
a++){this.markers[b[a]].element.remove(),delete this.markers[b[a]]
}},removeAllMarkers:function(){var b,a=[];
for(b in this.markers){a.push(b)
}this.removeMarkers(a)
},latLngToPoint:function(j,m){var d,b=jvm.WorldMap.maps[this.params.map].projection,g=b.centralMeridian,p=this.width-this.baseTransX*2*this.baseScale,c=this.height-this.baseTransY*2*this.baseScale,l,k,h=this.scale/this.baseScale;
return m<-180+g&&(m+=360),d=jvm.Proj[b.type](j,m,g),l=this.getInsetForPoint(d.x,d.y),l?(k=l.bbox,d.x=(d.x-k[0].x)/(k[1].x-k[0].x)*l.width*this.scale,d.y=(d.y-k[0].y)/(k[1].y-k[0].y)*l.height*this.scale,{x:d.x+this.transX*this.scale+l.left*this.scale,y:d.y+this.transY*this.scale+l.top*this.scale}):!1
},pointToLatLng:function(j,m){var d=jvm.WorldMap.maps[this.params.map].projection,b=d.centralMeridian,g=jvm.WorldMap.maps[this.params.map].insets,p,c,l,k,h;
for(p=0;
p<g.length;
p++){c=g[p],l=c.bbox,k=j-(this.transX*this.scale+c.left*this.scale),h=m-(this.transY*this.scale+c.top*this.scale),k=k/(c.width*this.scale)*(l[1].x-l[0].x)+l[0].x,h=h/(c.height*this.scale)*(l[1].y-l[0].y)+l[0].y;
if(k>l[0].x&&k<l[1].x&&h>l[0].y&&h<l[1].y){return jvm.Proj[d.type+"_inv"](k,-h,b)
}}return !1
},getInsetForPoint:function(d,b){var f=jvm.WorldMap.maps[this.params.map].insets,c,a;
for(c=0;
c<f.length;
c++){a=f[c].bbox;
if(d>a[0].x&&d<a[1].x&&b>a[0].y&&b<a[1].y){return f[c]
}}},createSeries:function(){var b,a;
this.series={markers:[],regions:[]};
for(a in this.params.series){for(b=0;
b<this.params.series[a].length;
b++){this.series[a][b]=new jvm.DataSeries(this.params.series[a][b],this[a])
}}},remove:function(){this.label.remove(),this.container.remove(),jvm.$(window).unbind("resize",this.onResize)
}},jvm.WorldMap.maps={},jvm.WorldMap.defaultParams={map:"world_mill_en",backgroundColor:"#505050",zoomButtons:!0,zoomOnScroll:!0,zoomMax:8,zoomMin:1,zoomStep:1.6,regionsSelectable:!1,markersSelectable:!1,bindTouchEvents:!0,regionStyle:{initial:{fill:"white","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":0.8},selected:{fill:"yellow"},selectedHover:{}},markerStyle:{initial:{fill:"grey",stroke:"#505050","fill-opacity":1,"stroke-width":1,"stroke-opacity":1,r:5},hover:{stroke:"black","stroke-width":2},selected:{fill:"blue"},selectedHover:{}}},jvm.WorldMap.apiEvents={onRegionLabelShow:"regionLabelShow",onRegionOver:"regionOver",onRegionOut:"regionOut",onRegionClick:"regionClick",onRegionSelected:"regionSelected",onMarkerLabelShow:"markerLabelShow",onMarkerOver:"markerOver",onMarkerOut:"markerOut",onMarkerClick:"markerClick",onMarkerSelected:"markerSelected",onViewportChange:"viewportChange"};